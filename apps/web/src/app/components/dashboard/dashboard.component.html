<div class="dashboard-container">
  <header class="header">
    <h1>Code Evolution Lab</h1>
    <p>AI-Powered Code Performance Analysis</p>
  </header>

  <div class="main-content">
    <div class="input-section">
      <h2>Code Input</h2>
      
      <div class="form-group">
        <label for="filePath">File Path</label>
        <input id="filePath" type="text" [(ngModel)]="filePath" placeholder="example.js" />
      </div>

      <div class="form-group">
        <label for="code">Code to Analyze</label>
        <textarea id="code" [(ngModel)]="code" placeholder="Paste your code here..." rows="15"></textarea>
      </div>

      <div class="form-group checkbox">
        <input id="generateSolutions" type="checkbox" [(ngModel)]="generateSolutions" />
        <label for="generateSolutions">Generate AI Solutions</label>
      </div>

      <div class="actions">
        <button class="btn btn-primary" (click)="analyzeCode()" [disabled]="analyzing">
          {{ analyzing ? 'Analyzing...' : 'Analyze Code' }}
        </button>
        <button class="btn btn-secondary" (click)="loadExample()">Load Example</button>
        <button class="btn btn-secondary" (click)="clearResults()" *ngIf="result">Clear Results</button>
      </div>
    </div>

    <div class="results-section" *ngIf="result || error">
      <div class="error-message" *ngIf="error">
        <h3>Error</h3>
        <p>{{ error }}</p>
      </div>

      <div class="analysis-results" *ngIf="result">
        <h2>Analysis Results</h2>
        
        <div class="score-card">
          <div class="score-value" [class.good]="result.score >= 80" [class.warning]="result.score >= 50 && result.score < 80" [class.bad]="result.score < 50">
            {{ result.score }}
          </div>
          <div class="score-label">Performance Score</div>
        </div>

        <div class="issues-summary">
          <h3>Issues Found: {{ result.totalIssues }}</h3>
          <div class="severity-badges">
            <span class="badge critical" *ngIf="result.issuesBySeverity.critical > 0">
              Critical: {{ result.issuesBySeverity.critical }}
            </span>
            <span class="badge high" *ngIf="result.issuesBySeverity.high > 0">
              High: {{ result.issuesBySeverity.high }}
            </span>
            <span class="badge medium" *ngIf="result.issuesBySeverity.medium > 0">
              Medium: {{ result.issuesBySeverity.medium }}
            </span>
            <span class="badge low" *ngIf="result.issuesBySeverity.low > 0">
              Low: {{ result.issuesBySeverity.low }}
            </span>
          </div>
        </div>

        <div class="detectors-results">
          <div class="detector-result" *ngFor="let detector of result.results">
            <h3>{{ detector.detectorName }}</h3>
            <p *ngIf="detector.issues.length === 0" class="no-issues">âœ“ No issues found</p>
            
            <div class="issues-list" *ngIf="detector.issues.length > 0">
              <div class="issue-card" *ngFor="let issue of detector.issues">
                <div class="issue-header">
                  <span class="severity-badge" [class]="issue.severity.toLowerCase()">{{ issue.severity }}</span>
                  <span class="issue-id">{{ issue.id }}</span>
                </div>
                <div class="issue-body">
                  <p class="issue-description">{{ issue.description }}</p>
                  <div class="code-block" *ngIf="issue.codeBefore">
                    <strong>Code:</strong>
                    <pre>{{ issue.codeBefore }}</pre>
                  </div>
                  <div class="solutions" *ngIf="issue.solutions && issue.solutions.length > 0">
                    <h4>Suggested Solutions ({{ issue.solutions.length }})</h4>
                    <div class="solution-card" *ngFor="let solution of issue.solutions">
                      <div class="solution-header">
                        <span class="solution-rank">Rank #{{ solution.rank }}</span>
                        <span class="fitness-score">Fitness: {{ solution.fitnessScore }}</span>
                      </div>
                      <p class="solution-description">{{ solution.description }}</p>
                      <div class="code-block">
                        <pre>{{ solution.codeAfter }}</pre>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
